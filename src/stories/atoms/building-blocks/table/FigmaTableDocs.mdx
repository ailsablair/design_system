import { Meta, Canvas, ArgTypes } from '@storybook/blocks';
import * as FigmaTableStories from './FigmaTable.stories';

<Meta of={FigmaTableStories} />

# FigmaTable Component

The `FigmaTable` component is a comprehensive data table implementation that exactly matches Figma design specifications. It provides rich content display capabilities with multiple cell types, interactive features, and responsive design.

## Overview

This component was built to provide pixel-perfect implementation of complex table designs with the following key features:

- **Multiple cell types**: title, text, multi-tag, links, rating, group-avatars, progress-bar, button-group
- **Two size variants**: default and small for different density requirements  
- **Interactive features**: row selection, column sorting, pagination
- **Header and footer**: with title, subtitle, count badge, and action buttons
- **Responsive design**: adapts to different screen sizes
- **Accessibility**: full keyboard navigation and screen reader support

## Design System Integration

The FigmaTable uses design tokens from the existing design system:

- **Colors**: Primary blue, sky blue, and neutral gray palettes
- **Typography**: Archivo and Roboto Flex font families with proper weights
- **Spacing**: Consistent padding and margins using design token values
- **Interactive states**: Hover, focus, and selection states with proper visual feedback

## Basic Usage

<Canvas of={FigmaTableStories.Default} />

## Size Variants

The component supports two size variants optimized for different use cases:

### Default Size
Perfect for standard data tables with comfortable spacing and readability.

<Canvas of={FigmaTableStories.Default} />

### Small Size  
Optimized for data-dense interfaces where space is at a premium.

<Canvas of={FigmaTableStories.Small} />

## Cell Types

The FigmaTable supports 8 different cell types to handle various content:

1. **Title**: Lead column with checkbox selection
2. **Text**: Simple text content 
3. **Multi-tag**: Tags with overflow indicators
4. **Links**: Action links (Edit/Delete)
5. **Rating**: Star rating display
6. **Group Avatars**: Avatar groups with overflow count
7. **Progress Bar**: Progress indicators with percentage
8. **Button Group**: Action buttons with icons

## Interactive Features

### Selection
- Individual row selection via checkboxes
- Bulk selection with "select all" functionality
- Indeterminate state for partial selections

### Sorting
- Clickable column headers for sortable columns
- Visual indicators for sort direction
- Support for ascending/descending states

### Pagination
- Previous/Next navigation buttons
- Page number selection with ellipsis for large datasets
- Customizable page ranges

## Configuration Options

<ArgTypes of={FigmaTableStories} />

## Examples

### Minimal Configuration
<Canvas of={FigmaTableStories.Minimal} />

### With Selection States
<Canvas of={FigmaTableStories.WithSelection} />

### Different Pagination States  
<Canvas of={FigmaTableStories.PaginationStates} />

### Alternative Background Colors
<Canvas of={FigmaTableStories.BlueBackground} />

## Responsive Behavior

The FigmaTable adapts to different screen sizes:

- **Desktop**: Full layout with all features visible
- **Tablet**: Condensed spacing while maintaining functionality
- **Mobile**: Stacked header actions and touch-optimized controls

<Canvas of={FigmaTableStories.Responsive} />

## Accessibility

The component includes comprehensive accessibility features:

- **Keyboard Navigation**: Full tab order and arrow key support
- **Screen Reader Support**: Proper ARIA labels and semantic HTML
- **Focus Management**: Visible focus indicators
- **Color Contrast**: WCAG AA compliant color combinations

## Performance Considerations

- **Virtual Scrolling**: For large datasets, consider implementing virtual scrolling
- **Pagination**: Use server-side pagination for datasets over 1000 items
- **Cell Rendering**: Complex cell types are optimized for performance
- **Responsive Design**: Mobile layouts prioritize essential information

## API Reference

### FigmaTableProps

```typescript
interface FigmaTableProps {
  title: string;
  subtitle?: string;
  itemCount: number;
  columns: FigmaTableColumn[];
  data: FigmaTableData[];
  size?: 'default' | 'small';
  currentPage?: number;
  totalPages?: number;
  showMoreActions?: boolean;
  showPagination?: boolean;
  showSubText?: boolean;
  headerFooterBg?: 'blue-50' | 'blue-100';
  className?: string;
  onSort?: (columnKey: string, direction: 'asc' | 'desc') => void;
  onRowSelect?: (rowId: string, selected: boolean) => void;
  onSelectAll?: (selected: boolean) => void;
  onPageChange?: (page: number) => void;
  onEdit?: (rowId: string) => void;
  onDelete?: (rowId: string) => void;
}
```

### FigmaTableColumn

```typescript
interface FigmaTableColumn {
  key: string;
  title: string;
  type: 'title' | 'text' | 'multi-tag' | 'links' | 'rating' | 'group-avatars' | 'progress-bar' | 'button-group';
  width?: string;
  isLead?: boolean;
  sortable?: boolean;
  sortDirection?: 'asc' | 'desc' | null;
}
```

### FigmaTableData

```typescript
interface FigmaTableData {
  id: string;
  selected?: boolean;
  [key: string]: any;
}
```

## Related Components

- **TableCell**: Individual cell component used within FigmaTable
- **AvatarGroup**: Used for group-avatars cell type
- **ProgressBar**: Used for progress-bar cell type
- **Star**: Used for rating cell type
- **Tag**: Used for multi-tag cell type
- **Button**: Used for button-group cell type

## Best Practices

1. **Column Configuration**: Define clear column types and widths
2. **Data Structure**: Ensure consistent data structure across rows
3. **Performance**: Use pagination for large datasets
4. **Accessibility**: Provide clear labels and descriptions
5. **Responsive**: Test on different screen sizes
6. **Error Handling**: Handle loading and empty states gracefully

## Troubleshooting

### Common Issues

**Table not rendering**: Check that columns and data props are properly configured
**Styles not applying**: Ensure CSS file is imported and design tokens are available
**Selection not working**: Verify onRowSelect and onSelectAll handlers are implemented
**Pagination issues**: Check currentPage and totalPages props are correctly set

### Performance Tips

- Use React.memo for cell components with complex content
- Implement virtual scrolling for very large datasets
- Consider server-side pagination and sorting
- Optimize image loading in avatar cells

This component provides a robust foundation for data-heavy interfaces while maintaining design consistency and accessibility standards.
